
{% extends "base.html" %}

{% block title %}Admin Dashboard - Helping Hand Together{% endblock %}

{% block head %}
<style>
.dashboard-card {
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    border: none;
    border-radius: 15px;
}
.dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}
.stat-icon {
    font-size: 3rem;
    opacity: 0.3;
    position: absolute;
    right: 20px;
    top: 20px;
}
.action-card {
    border: none;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}
.action-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 15px rgba(0,0,0,0.15);
}
.list-group-item-action:hover {
    background-color: #f8f9fa;
    transform: translateX(5px);
    transition: all 0.2s ease;
}
.gradient-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
.gradient-success {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
}
.gradient-warning {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}
.gradient-info {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}
.gradient-dark {
    background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
}
.gradient-purple {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid my-4">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-4 fw-bold text-primary mb-1">Admin Dashboard</h1>
            <p class="lead text-muted">Comprehensive platform management and analytics</p>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row mb-5">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card dashboard-card gradient-primary text-white h-100">
                <div class="card-body position-relative">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-white-50 text-uppercase mb-1">Total Users</div>
                            <div class="h2 mb-0 font-weight-bold">{{ total_users }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-people stat-icon"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card dashboard-card gradient-success text-white h-100">
                <div class="card-body position-relative">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-white-50 text-uppercase mb-1">Total Campaigns</div>
                            <div class="h2 mb-0 font-weight-bold">{{ total_campaigns }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-flag stat-icon"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card dashboard-card gradient-warning text-white h-100">
                <div class="card-body position-relative">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-white-50 text-uppercase mb-1">Pending KYC</div>
                            <div class="h2 mb-0 font-weight-bold">{{ pending_kyc }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-shield-exclamation stat-icon"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card dashboard-card gradient-info text-white h-100">
                <div class="card-body position-relative">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-white-50 text-uppercase mb-1">Total Raised</div>
                            <div class="h2 mb-0 font-weight-bold">${{ "%.2f"|format(total_raised) }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="bi bi-currency-dollar stat-icon"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mb-4">
        <!-- Core Management -->
        <div class="col-lg-4 mb-4">
            <div class="card action-card h-100">
                <div class="card-header gradient-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-gear-fill"></i> Core Management</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="{{ url_for('admin.kyc_management') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <div>
                            <i class="bi bi-file-earmark-person text-primary"></i>
                            <strong>Enhanced KYC Management</strong>
                            <small class="d-block text-muted">View documents with image viewer</small>
                        </div>
                        <span class="badge bg-warning">{{ pending_kyc }}</span>
                    </a>
                    <a href="{{ url_for('admin.campaigns') }}?status=pending" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <div>
                            <i class="bi bi-flag text-success"></i>
                            <strong>Campaign Approvals</strong>
                            <small class="d-block text-muted">Review and publish campaigns</small>
                        </div>
                        <span class="badge bg-danger">{{ pending_campaigns }}</span>
                    </a>
                    <a href="{{ url_for('admin.donations') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-heart text-danger"></i>
                            <strong>Donation Management</strong>
                            <small class="d-block text-muted">Verify and confirm donations</small>
                        </div>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Advanced Features -->
        <div class="col-lg-4 mb-4">
            <div class="card action-card h-100">
                <div class="card-header gradient-dark text-white">
                    <h5 class="mb-0"><i class="bi bi-stars"></i> Advanced Features</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="{{ url_for('admin.users_advanced') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-people-fill text-info"></i>
                            <strong>Advanced User Management</strong>
                            <small class="d-block text-muted">Location data, activities & analytics</small>
                        </div>
                    </a>
                    <a href="{{ url_for('admin.analytics') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-graph-up text-success"></i>
                            <strong>Analytics Dashboard</strong>
                            <small class="d-block text-muted">Comprehensive statistics & insights</small>
                        </div>
                    </a>
                    <a href="{{ url_for('admin.manage_notifications') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-bell text-warning"></i>
                            <strong>Notification Center</strong>
                            <small class="d-block text-muted">Manage system notifications</small>
                        </div>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- System & Security -->
        <div class="col-lg-4 mb-4">
            <div class="card action-card h-100">
                <div class="card-header gradient-purple text-white">
                    <h5 class="mb-0"><i class="bi bi-shield-lock-fill"></i> System & Security</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="{{ url_for('admin.payment_methods') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-credit-card-2-front text-primary"></i>
                            <strong>Payment Methods</strong>
                            <small class="d-block text-muted">Secure payment configuration</small>
                        </div>
                    </a>
                    <a href="{{ url_for('admin.system_settings') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-sliders text-secondary"></i>
                            <strong>System Settings</strong>
                            <small class="d-block text-muted">Platform configuration</small>
                        </div>
                    </a>
                    <a href="{{ url_for('admin.locations') }}" class="list-group-item list-group-item-action">
                        <div>
                            <i class="bi bi-geo-alt text-info"></i>
                            <strong>Location Management</strong>
                            <small class="d-block text-muted">Manage supported locations</small>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Content & Communication -->
    <div class="row mb-4">
        <div class="col-lg-6">
            <div class="card action-card">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-newspaper text-dark"></i> Content Management</h5>
                </div>
                <div class="row g-0">
                    <div class="col-6">
                        <a href="{{ url_for('admin.news') }}" class="d-block p-4 text-decoration-none text-center border-end">
                            <i class="bi bi-journal-text text-primary" style="font-size: 2rem;"></i>
                            <h6 class="mt-2 mb-0">Manage News</h6>
                            <small class="text-muted">Articles & Updates</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('admin.users') }}" class="d-block p-4 text-decoration-none text-center">
                            <i class="bi bi-people text-success" style="font-size: 2rem;"></i>
                            <h6 class="mt-2 mb-0">User Directory</h6>
                            <small class="text-muted">Basic User Management</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-6">
            <div class="card action-card">
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="bi bi-activity text-dark"></i> Recent Activity</h5>
                    <a href="{{ url_for('admin.analytics') }}" class="btn btn-sm btn-outline-primary">View All</a>
                </div>
                <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                    {% if recent_donations %}
                        {% for donation in recent_donations %}
                        <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                            <div>
                                <h6 class="mb-1">${{ "%.2f"|format(donation.amount) }}</h6>
                                <small class="text-muted">{{ donation.donor_name or 'Anonymous' }}</small>
                                <div class="small text-primary">{{ donation.campaign.title[:30] }}...</div>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-{{ 'success' if donation.status == 'completed' else 'warning' }}">{{ donation.status.title() }}</span>
                                <div class="small text-muted">{{ donation.created_at.strftime('%m/%d') }}</div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center text-muted py-4">
                            <i class="bi bi-inbox" style="font-size: 3rem; opacity: 0.3;"></i>
                            <p class="mt-2 mb-0">No recent donations</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Stats -->
    <div class="row">
        <div class="col-12">
            <div class="card action-card">
                <div class="card-header bg-gradient-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-speedometer2"></i> Platform Health</h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-3">
                            <div class="p-3">
                                <i class="bi bi-check-circle text-success" style="font-size: 2rem;"></i>
                                <h4 class="mt-2 mb-1">{{ total_donations }}</h4>
                                <small class="text-muted">Completed Donations</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="p-3">
                                <i class="bi bi-clock text-warning" style="font-size: 2rem;"></i>
                                <h4 class="mt-2 mb-1">{{ pending_campaigns }}</h4>
                                <small class="text-muted">Pending Campaigns</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="p-3">
                                <i class="bi bi-eye text-info" style="font-size: 2rem;"></i>
                                <h4 class="mt-2 mb-1">{{ recent_users|length }}</h4>
                                <small class="text-muted">Recent Users</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="p-3">
                                <i class="bi bi-graph-up text-primary" style="font-size: 2rem;"></i>
                                <h4 class="mt-2 mb-1">Active</h4>
                                <small class="text-muted">System Status</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Add loading animation for cards
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.dashboard-card, .action-card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.5s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
});

// Auto-refresh dashboard every 5 minutes
setTimeout(() => {
    location.reload();
}, 300000);
</script>
{% endblock %}
